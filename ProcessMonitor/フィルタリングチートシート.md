# フィルタリングチートシート
  
<br>
  
## API操作関連
- 悪意あるツールなどはファイルを生成しがちなので、`CreateFile`、`WriteFile`で確認するときっかけが掴めるかも
- 作成されたはずのファイルが見つからないときは、削除されていないかを確認する
- 名前を変えられるというケースも考えられるので、リネームされた処理を確認する  
  
| フィルタ内容 | 設　定 | 備　考 |
| --- | --- | --- |
| ファイル書込み | [ opreration ][ is ][ WriteFile ] | ファイルに書き込みされていないか |
| ファイル作成 | [ opreration ][ is ][ CreateFile ] | ファイルが作成されていないか |
| ファイル・フォルダの削除 | [ Deteil ][ is ][ Delete: True] | ファイル・ファルダが削除されていないか |
| ファイル削除 | [ Deteil ][ begin with ][ Desired Access: Delete ] | ファイル・ファルダが削除されていないか |
| ファイル・フォルダのリネーム | [ Operation ][ is ][ SetRenameInformationFile ] | リネームされていないか |
  
<br>
  
## ファイルパス関連
解析したいプロセスに関連するファイルやフォルダが特定できているなら、ファイルパスで指定すると絞り込みやすい  
  
| フィルタ内容 | 設　定 | 備　考 |
| --- | --- | --- |
| 特定のファイルの処理 | [ Path ][ conteins ][ ファイル名 ] |  |
| フォルダ配下すべての処理 | [ Path ][ conteins ][ フォルダ名 ] |  |
| 特定の拡張子の処理 | [ Path ][ conteins ][ .拡張子 ] |  |
|  |  |  |
  
<br>
  
## プロセスID関連
- `ProcessTree`から解析したいプロセスを選択してフィルタするのが直感的  
  
| フィルタ内容 | 設　定 | 備　考 |
| --- | --- | --- |
| 特定のプロセスIDの表示 | [ PID ][ is ][ プロセスID ] |  |
| 親子プロセスの表示 | [ Process Tree ] -> [ 親子プロセスを選択 ] -> [ Include Subtree ] | Process Treeからの操作手順 |
| 特定のプロセスの表示 | [ Process Tree ] -> [ プロセスを選択 ] -> [ Include Include ] | Process Treeからの操作手順 |
|  |  |  |
  
<br>
  
## 新規プロセス関連
- `ProcessCreate`でフィルタすることで、不審な挙動をするプロセスからさらに別のプロセスが作られていないか確認できる  
  
| フィルタ内容 | 設　定 | 備　考 |
| --- | --- | --- |
| プロセスの作成 | [ Operation ][ is ][ Process Create ]|  |
| プロセスの開始 | [ Operation ][ is ][ Process Start ] |  |
|  |  |  |
　　
<br>
  
## レジストリ関連
- `RegSetValue`でフィルタすることで、起動時に実行させるレジストリ登録や自分自身をレジストリに保存する挙動を確認できる  
  
| フィルタ内容 | 設　定 | 備　考 |
| --- | --- | --- |
| レジストリ書込み | [ Operation ][ is ][ RegSetValue ] |  |
|  |  |  |
　　
<br>
  
## カテゴリーフィルタ
カテゴリーでフィルタすることで、ざっくり書込み・読み込み関連の挙動が確認できる  
  
| フィルタ内容 | 設　定 | 備　考 |
| --- | --- | --- |
| 書込み処理 | [ Category ][ is ][ Write ] |  |
| 書込み処理(メタデータ) | [ Category ][ is ][ Write Metadate ] |  |
| 読み込み処理 | [ Category ][ is ][ Read ] |  |
| 書込み処理(メタデータ) | [ Category ][ is ][ Read Metadate ] |  |
　　
<br>